{% extends 'baseusuario.html' %}

{% block content %}
<div class="container">
  <h2 class="text-center display-4 py-4">Enviar Mensaje a Administración</h2>
  
  <form method="POST">
    {% csrf_token %}
    
    <div class="form-group">
      <label for="tipo_consulta">Tipo de Consulta:</label>
      <select class="form-control" id="tipo_consulta" name="tipo_consulta">
        <option value="consulta">Consulta</option>
        <option value="peticion">Petición</option>
        <option value="ayuda">Ayuda</option>
        <option value="reporte">Reporte</option>
      </select>
    </div>
    
    <div class="form-group" id="tipo_especifico_container">
      <label for="tipo_especifico">Detalles específicos:</label>
      <select class="form-control" id="tipo_especifico" name="tipo_especifico">
        <option value="" selected disabled>Selecciona un detalle específico</option>
        <!-- Opciones predefinidas para cada tipo de consulta -->
        <optgroup label="Consulta">
          <option value="informacion">Información</option>
          <option value="aclaracion">Aclaración</option>
          <option value="duda">Duda</option>
        </optgroup>
        <optgroup label="Petición">
          <option value="accion">Acción</option>
          <option value="solicitud">Solicitud</option>
          <option value="requisito">Requisito</option>
        </optgroup>
        <optgroup label="Ayuda">
          <option value="asistencia">Asistencia</option>
          <option value="orientacion">Orientación</option>
          <option value="apoyo">Apoyo</option>
        </optgroup>
        <optgroup label="Reporte">
          <option value="problema">Problema</option>
          <option value="error">Error</option>
          <option value="bug">Bug</option>
        </optgroup>
      </select>
    </div>
    
    <div class="form-group">
      <label for="titulo">Título:</label>
      <input type="text" class="form-control" id="titulo" name="titulo" required>
    </div>
    
    <div class="form-group">
      <label for="mensaje">Mensaje:</label>
      <textarea class="form-control" id="mensaje" name="mensaje" rows="5" required></textarea>
    </div>
    
    <button type="submit" class="btn btn-primary">Enviar</button>
  </form>
  
  <a href="/contacta/" class="btn btn-secondary mt-3">Volver</a>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
  var tipoConsultaSelect = document.getElementById("tipo_consulta");
  var tipoEspecificoContainer = document.getElementById("tipo_especifico_container");
  var tipoEspecificoSelect = document.getElementById("tipo_especifico");

  tipoConsultaSelect.addEventListener("change", function() {
    if (tipoConsultaSelect.value === "consulta") {
      tipoEspecificoContainer.style.display = "block";
      tipoEspecificoSelect.innerHTML = `
        <option value="" selected disabled>Selecciona un detalle específico</option>
        <optgroup label="Consulta">
          <option value="informacion">Información</option>
          <option value="aclaracion">Aclaración</option>
          <option value="duda">Duda</option>
        </optgroup>
      `;
    } else if (tipoConsultaSelect.value === "peticion") {
      tipoEspecificoContainer.style.display = "block";
      tipoEspecificoSelect.innerHTML = `
        <option value="" selected disabled>Selecciona un detalle específico</option>
        <optgroup label="Petición">
          <option value="accion">Acción</option>
          <option value="solicitud">Solicitud</option>
          <option value="requisito">Requisito</option>
        </optgroup>
      `;
    } else if (tipoConsultaSelect.value === "ayuda") {
      tipoEspecificoContainer.style.display = "block";
      tipoEspecificoSelect.innerHTML = `
        <option value="" selected disabled>Selecciona un detalle específico</option>
        <optgroup label="Ayuda">
          <option value="asistencia">Asistencia</option>
          <option value="orientacion">Orientación</option>
          <option value="apoyo">Apoyo</option>
        </optgroup>
      `;
    } else if (tipoConsultaSelect.value === "reporte") {
      tipoEspecificoContainer.style.display = "block";
      tipoEspecificoSelect.innerHTML = `
        <option value="" selected disabled>Selecciona un detalle específico</option>
        <optgroup label="Reporte">
          <option value="problema">Problema</option>
          <option value="error">Error</option>
          <option value="bug">Bug</option>
        </optgroup>
      `;
    } else {
      tipoEspecificoContainer.style.display = "none";
    }
  });
});
</script>

{% endblock %}
